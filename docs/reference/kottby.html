<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimation of totals and means — kottby • EVER</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimation of totals and means — kottby" />
<meta property="og:description" content="Calculates estimates, standard errors and confidence intervals for totals and means in subpopulations." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EVER</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimation of totals and means</h1>
    
    <div class="hidden name"><code>kottby.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates estimates, standard errors and confidence intervals for totals and means in subpopulations.</p>
    </div>

    <pre class="usage"><span class='fu'>kottby</span>(<span class='no'>deskott</span>, <span class='no'>y</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>estimator</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"total"</span>, <span class='st'>"mean"</span>),
       <span class='kw'>vartype</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"se"</span>, <span class='st'>"cv"</span>, <span class='st'>"cvpct"</span>, <span class='st'>"var"</span>),
       <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>conf.lev</span> <span class='kw'>=</span> <span class='fl'>0.95</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>deskott</th>
      <td><p>Object of class <code>kott.design</code> containing the replicated survey data.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Formula defining the variables of interest.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>Formula specifying the variables that define the "estimation domains". If <code>NULL</code> (the default option) estimates refer to the whole population.</p></td>
    </tr>
    <tr>
      <th>estimator</th>
      <td><p><code>character</code> specifying the desired estimator: it may be <code>"total"</code> (the default) or <code>"mean"</code>.</p></td>
    </tr>
    <tr>
      <th>vartype</th>
      <td><p><code>character</code> vector specifying the desired variability estimators. It is possible to choose one or more of: standard error (the default), coefficient of variation, percent coefficient of variation, or variance.</p></td>
    </tr>
    <tr>
      <th>conf.int</th>
      <td><p>Boolean (<code>logical</code>) value to request confidence intervals for the estimates: the default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>conf.lev</th>
      <td><p>Probability specifying the desired confidence level: the default value is <code>0.95</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function calculates weighted estimates for totals and means using suitable weights depending on the class of <code>deskott</code>: calibrated weights for class <code>kott.cal.design</code> and direct weights otherwise. Standard errors are calculated using the extended DAGJK method [Kott 99-01].</p>
<p>The mandatory argument <code>y</code> identifies the variables of interest, that is the variables for which estimates are to be calculated. The corresponding formula must be of the type <code>y=~var1+&#8230;+varn</code>. The <code>deskott</code> variables referenced by <code>y</code> must be <code>numeric</code> or <code>factor</code> and must not contain any missing value (<code>NA</code>). It is admissible to specify for <code>y</code> "mixed" formulas that simultaneously contain quantitative (<code>numeric</code>) variables and qualitative (<code>factor</code>) variables.</p>
<p>The optional argument <code>by</code> specifies the variables that define the "estimation domains", that is the subpopulations for which the estimates are to be calculated. If <code>by=NULL</code> (the default option), the estimates produced by <code>kottby</code> refer to the whole population. Estimation domains must be defined by a formula: for example the statement <code>by=~B1:B2</code> selects as estimation domains the subpopulations determined by crossing the modalities of variables <code>B1</code> and <code>B2</code>. The <code>deskott</code> variables referenced by <code>by</code> (if any) must be <code>factor</code> and must not contain any missing value (<code>NA</code>).</p>
<p>The optional argument <code>estimator</code> makes it possible to select the desired estimator. If<br /> <code>estimator="total"</code> (the default option), <code>kottby</code> calculates, for a given variable of interest <code>vark</code>, the estimate of the total (when <code>vark</code> is <code>numeric</code>) or the estimate of the absolute frequency distribution (when <code>vark</code> is <code>factor</code>). Similarly, if <code>estimator="mean"</code>, the function calculates the estimate of the mean (when <code>vark</code> is <code>numeric</code>) or the the estimate of the relative frequency distribution (when <code>vark</code> is <code>factor</code>).</p>
<p>The <code>conf.int</code> argument allows to request the confidence intervals for the estimates. By default <code>conf.int=FALSE</code>, that is the confidence intervals are not provided.</p>
<p>Whenever confidence intervals are requested (i.e. <code>conf.int=TRUE</code>), the desired confidence level can be specified by means of the <code>conf.lev</code> argument. The <code>conf.lev</code> value must represent a probability (<code>0&lt;=conf.lev&lt;=1</code>) and its default is chosen to be <code>0.95</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The return value depends on the value of the input parameters. In the most general case, the function returns an object of class <code>list</code> (typically a list made up of data frames).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The advantage of the DAGJK method over the traditional jackknife is that, unlike the latter, it remains computationally manageable even when dealing with "complex and big" surveys (tens of thousands of PSUs arranged in a large number of strata with widely varying sizes). In fact, the DAGJK method is known to provide, for a broad range of sampling designs and estimators, (near) unbiased standard error estimates even with a "small" number (e.g. a few tens) of replicate weights. On the other hand, if the number of replicates is not large, it seems defensible to use a <em>t distribution</em> (rather than a normal distribution) for calculating the confidence intervals. In line with what was proposed in [Kott 99-01], given an input <code>kott.design</code> object with <code>nrg</code> random groups, <code>kottby</code> builds the confidence intervals making use of a t distribution with <code>nrg-1</code> degrees of freedom.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kott, Phillip S. (1999) <em>"The Extended Delete-A-Group Jackknife"</em>. Bulletin of the International Statistical Instititute. 52nd Session. Contributed Papers. Book 2, pp. 167-168.</p>
<p>Kott, Phillip S. (2001) <em>"The Delete-A-Group Jackknife"</em>. Journal of Official Statistics, Vol.17, No.4, pp. 521-526.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='kott.ratio.html'>kott.ratio</a></code> for estimating ratios between totals, <code><a href='kott.quantile.html'>kott.quantile</a></code> for estimating quantiles, <code><a href='kott.regcoef.html'>kott.regcoef</a></code> for estimating regression coefficients and <code><a href='kottby.user.html'>kottby.user</a></code> for calculating estimates based on user-defined estimators.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>data.examples</span>)

<span class='co'># Creation of a kott.design object:</span>
<span class='no'>kdes</span><span class='kw'>&lt;-</span><span class='fu'><a href='kottdesign.html'>kottdesign</a></span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>example</span>,<span class='kw'>ids</span><span class='kw'>=</span>~<span class='no'>towcod</span>+<span class='no'>famcod</span>,<span class='kw'>strata</span><span class='kw'>=</span>~<span class='no'>SUPERSTRATUM</span>,
      <span class='kw'>weights</span><span class='kw'>=</span>~<span class='no'>weight</span>,<span class='kw'>nrg</span><span class='kw'>=</span><span class='fl'>15</span>)


<span class='co'># Estimate of the total of 3 quantitative variables for the whole</span>
<span class='co'># population:</span>
<span class='fu'>kottby</span>(<span class='no'>kdes</span>,~<span class='no'>y1</span>+<span class='no'>y2</span>+<span class='no'>y3</span>)</div><div class='output co'>#&gt; $y1
#&gt;       total       SE
#&gt; y1 381111.8 16251.66
#&gt; 
#&gt; $y2
#&gt;       total       SE
#&gt; y2 356633.5 16291.13
#&gt; 
#&gt; $y3
#&gt;      total       SE
#&gt; y3 24478.3 2439.861
#&gt; </div><div class='input'>

<span class='co'># Estimate of the total of the same 3 variables by sex: </span>
<span class='fu'>kottby</span>(<span class='no'>kdes</span>,~<span class='no'>y1</span>+<span class='no'>y2</span>+<span class='no'>y3</span>,~<span class='no'>sex</span>)</div><div class='output co'>#&gt; $y1
#&gt;              f        m
#&gt; total 191585.8   189526
#&gt; SE    11199.24 8314.135
#&gt; 
#&gt; $y2
#&gt;              f        m
#&gt; total 181179.5   175454
#&gt; SE    11663.96 7591.745
#&gt; 
#&gt; $y3
#&gt;              f      m
#&gt; total  10406.3  14072
#&gt; SE    1257.641 2156.7
#&gt; </div><div class='input'>

<span class='co'># Estimate of the mean of the same 3 variables by marstat and sex:</span>
<span class='fu'>kottby</span>(<span class='no'>kdes</span>,~<span class='no'>y1</span>+<span class='no'>y2</span>+<span class='no'>y3</span>,~<span class='no'>marstat</span>:<span class='no'>sex</span>,<span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"mean"</span>)</div><div class='output co'>#&gt; $y1
#&gt;       married.f unmarried.f  widowed.f  married.m unmarried.m  widowed.m
#&gt; mean  0.3907492   0.4235675  0.4626949  0.4067734   0.4394581  0.4018789
#&gt; SE   0.02016379  0.02838279 0.04654907 0.01356993  0.01807067 0.04700886
#&gt; 
#&gt; $y2
#&gt;       married.f unmarried.f widowed.f  married.m unmarried.m  widowed.m
#&gt; mean  0.3669468   0.4042538  0.440711  0.3826893   0.3906832  0.3952614
#&gt; SE   0.02073544  0.02765722 0.0452096 0.01490486   0.0140276 0.04720339
#&gt; 
#&gt; $y3
#&gt;        married.f unmarried.f  widowed.f   married.m unmarried.m   widowed.m
#&gt; mean  0.02380235  0.01931368 0.02198388  0.02408417   0.0487749 0.006617401
#&gt; SE   0.005086532 0.006118989 0.01280707 0.006835304 0.008965009 0.006673789
#&gt; </div><div class='input'>

<span class='co'># Estimate of the absolute frequency distribution of the qualitative</span>
<span class='co'># variable age5c for the whole population:</span>
<span class='fu'>kottby</span>(<span class='no'>kdes</span>,~<span class='no'>age5c</span>)</div><div class='output co'>#&gt;            total        SE
#&gt; age5c.1 128928.4  6872.904
#&gt; age5c.2 294575.1 11047.742
#&gt; age5c.3 356463.9 10033.262
#&gt; age5c.4 122897.6  9700.259
#&gt; age5c.5  21236.3  2459.820</div><div class='input'>

<span class='co'># Estimate of the relative frequency distribution of the qualitative</span>
<span class='co'># variable marstat by sex:</span>
<span class='fu'>kottby</span>(<span class='no'>kdes</span>,~<span class='no'>marstat</span>,~<span class='no'>sex</span>,<span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"mean"</span>)</div><div class='output co'>#&gt; $f
#&gt;                         mean          SE
#&gt; marstat.married   0.58198769 0.014765985
#&gt; marstat.unmarried 0.33855429 0.012208442
#&gt; marstat.widowed   0.07945802 0.007813969
#&gt; 
#&gt; $m
#&gt;                         mean          SE
#&gt; marstat.married   0.57948707 0.014615787
#&gt; marstat.unmarried 0.33810508 0.012797112
#&gt; marstat.widowed   0.08240785 0.007581132
#&gt; </div><div class='input'>

<span class='co'># The same with confidence intervals at a confidence level of 0.9:</span>
<span class='fu'>kottby</span>(<span class='no'>kdes</span>,~<span class='no'>marstat</span>,~<span class='no'>sex</span>,<span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"mean"</span>,<span class='kw'>conf.int</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>conf.lev</span><span class='kw'>=</span><span class='fl'>0.9</span>)</div><div class='output co'>#&gt; $f
#&gt;                         mean          SE l.conf(90%) u.conf(90%)
#&gt; marstat.married   0.58198769 0.014765985   0.5559802  0.60799517
#&gt; marstat.unmarried 0.33855429 0.012208442   0.3170514  0.36005714
#&gt; marstat.widowed   0.07945802 0.007813969   0.0656952  0.09322084
#&gt; 
#&gt; $m
#&gt;                         mean          SE l.conf(90%) u.conf(90%)
#&gt; marstat.married   0.57948707 0.014615787  0.55374414  0.60523001
#&gt; marstat.unmarried 0.33810508 0.012797112  0.31556540  0.36064476
#&gt; marstat.widowed   0.08240785 0.007581132  0.06905512  0.09576057
#&gt; </div><div class='input'>

<span class='co'># Quantitative and qualitative variables together: estimate of the</span>
<span class='co'># total for y3 and of the absolute frequency distribution of marstat,</span>
<span class='co'># by sex:</span>
<span class='fu'>kottby</span>(<span class='no'>kdes</span>,~<span class='no'>y3</span>+<span class='no'>marstat</span>,~<span class='no'>sex</span>)</div><div class='output co'>#&gt; $y3
#&gt;              f      m
#&gt; total  10406.3  14072
#&gt; SE    1257.641 2156.7
#&gt; 
#&gt; $marstat
#&gt; $marstat$f
#&gt;                      total        SE
#&gt; marstat.married   273569.6 10364.019
#&gt; marstat.unmarried 159141.1  7800.659
#&gt; marstat.widowed    37350.1  3747.368
#&gt; 
#&gt; $marstat$m
#&gt;                      total       SE
#&gt; marstat.married   263110.6 6942.904
#&gt; marstat.unmarried 153513.4 9042.946
#&gt; marstat.widowed    37416.5 3807.603
#&gt; 
#&gt; </div><div class='input'>

<span class='co'># Lonely PSUs do not give rise to NaNs in the standard errors:</span>
<span class='no'>kdes.lpsu</span><span class='kw'>&lt;-</span><span class='fu'><a href='kottdesign.html'>kottdesign</a></span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>example</span>,<span class='kw'>ids</span><span class='kw'>=</span>~<span class='no'>towcod</span>+<span class='no'>famcod</span>,<span class='kw'>strata</span><span class='kw'>=</span>~<span class='no'>stratum</span>,
           <span class='kw'>weights</span><span class='kw'>=</span>~<span class='no'>weight</span>,<span class='kw'>nrg</span><span class='kw'>=</span><span class='fl'>15</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Lonely PSUs in strata: 902, 903, 904, 905, 906, 907, 1004, 1005, 1006, 1007, 1008, 1102, 1103, 1104, 3002, 3003, 3004, 3005, 3006, 3007, 3008, 3009, 3010, 3105, 3106, 3107, 5407, 5408, 5409, 5410, 5411, 5412, 5413, 5415, 5416, 5502, 5503, 9304, 9305, 9306, 9307, 9308, 9309, 9310, 9312</span></div><div class='input'><span class='fu'>kottby</span>(<span class='no'>kdes.lpsu</span>,~<span class='no'>x1</span>+<span class='no'>x2</span>+<span class='no'>x3</span>)</div><div class='output co'>#&gt; $x1
#&gt;    total       SE
#&gt; x1 57412 3383.581
#&gt; 
#&gt; $x2
#&gt;      total       SE
#&gt; x2 19635.2 2777.078
#&gt; 
#&gt; $x3
#&gt;      total       SE
#&gt; x3 20552.6 1848.088
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Diego Zardetto</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Diego Zardetto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

